
<div class="container-fluid">

    <h2>Stock List with 20 Day Rolling AVG</h2>
    <br><br>
    <div class="forms">

        
        <form id="addBtn" method="POST" action="/symbols">
            <input type="text" name="name" value="<%= stocks.ticker %>">
            <button class="btn btn-primary" type="submit"  >Add to All Stocks List</button>
        </form>
        <br>
        <form id="updateBtn" method="POST" action="/symbols?_method=PUT">
            <input hidden type="text" name="name" value="<%= stocks.ticker %>">
            <button type="submit">Update All Table Data üìàüíπ</button>
        </form>
        <br>
        
        <form id="filterBtn" method="GET" action="/symbols/number">
            <label for="number">Filter by price</label> <br>
            <input type="number" name="number" value=""> 
            <button class="btn btn-primary" type="submit"  >Go</button>
        </form>
    </div>
    
     

    <hr>
    
    <div class="tableHeaders">
<h4>All Stocks + 20 and 70 Day Breakouts</h4>
<h4>Stocks closed below 20 Day Rolling Average</h4>
<h4>Reddit WallStreet Bets </h4>
    </div>


    <div class=" w3row bothtables"><% //div for all tables %>
        <div class=w3column>


           
            
            
            <% //Should have a check box to potentially hide all stocks where last close is higher%>
            
            <table class="w3row table-bordered smtable my-custom-scrollbar table-wrapper-scroll-y ">
                            
                            
                            
                <thead>
                    <tr>
                        <th scope="col">All Stocks</th>
                        <th scope="col">20 D</th>
                        <th scope="col">70 D</th>

                    </tr> 
                </thead>


                <% stocks.forEach(function(stock) { %>
                    <% //if(stock.lastClose < num ){%>
                        
                            <%if(stock.twentyDayBreakout == true || stock.seventyDayBreakout ==true){%>
                                
                                <tr class="green">
                                    <th><u><a href="/symbols/details/<%=stock.ticker%>"><%= (stock.ticker) %></a></u></th>
                                    <td class="col-sm"><p><u><%= (stock.twentyDayBreakout) %></u></p></td>
                                    <td class="col-sm"><p><u><%= (stock.seventyDayBreakout) %></u></p></td>
                                    
                                    <td class="col-sm"><form action="/symbols/<%=stock.ticker%>?_method=DELETE" method="POST">
                                        <button type="submit" name="ticker" value="<%=stock.ticker%>">‚ùå</button>
                                    </form></td>
                                </tr>
                                
                                
                                <%}else{%>
                                    <tr>
                                        
                                        <th><a href="/symbols/details/<%=stock.ticker%>"><%= (stock.ticker) %></a></th>
                                        <td><%= (stock.twentyDayBreakout) %></td>
                                        <td><%= (stock.seventyDayBreakout) %></td>
                                        
                                        <td><form action="/symbols/<%=stock.ticker%>?_method=DELETE" method="POST">
                                            <button type="submit" name="ticker" value="<%=stock.ticker%>">‚ùå</button>
                                        </form></td>
                                    </tr>
                                    <%}%>
                        </div>
                                
                                <%//}%>
                                
                                <%})%>
                                
                                
                            
                                
                                
            
                            
                                
            </table>
        </div>   
            
            <table class=" w3row table-bordered bigtable my-custom-scrollbar table-wrapper-scroll-y ">
                
                
                
                                
                <thead>
                    
                    <th scope="col"><p>Stock</p></th>
                                    <th scope="col"><p>Rolling Avg</p></th>
                                    <th scope="col"><p>Last Close</p></th>
                                    <th scope="col"><p>Date Run</p></th>
                                   
                                    
                                    
                                </thead>
                                
                                <% let i = 0 %>


                                <% stocks.forEach(function(stock) { %>
                                    
                                    <tbody>
                                        
                                        <%if(stock.rollingAvg > stock.lastClose){%>
                                            <%i++%>
                                            
                                                <tr class="green">
                                                    
                                                    <th><u><a href="/symbols/details/<%=stock.ticker%>"><%= (stock.ticker) %></a></u></th>
                                                    <td><u><%= (stock.rollingAvg) %></u></td>
                                                    <td><u><%= (stock.lastClose) %></u></td> 
                                                    <td><u><%= (stock.date.toLocaleString()) %></u></td>
                                                   
                                                    
                                    </tr>
                                </div>
                            </tbody>
                            
                            
                            <%}%>
                            
                            
                            
                            <%})%>
                            
                            
                        </table> 
                   


     <% // WSB TABLE %>
     
     <table class="wsbTable w3row table-bordered  my-custom-scrollbar table-wrapper-scroll-y table-sm">
               
         
         <thead>
             
             
             <th scope="col"><p>Ticker</p></th>
             <th scope="col"><p>Sentiment</p></th>
             <th scope="col"><p>Sentiment Score</p></th>
             <th scope="col"><p>Updated At</p></th>
             
            </thead>
            
                        
                        
                        <% wsb.forEach(function(wsbitem) { %>
                            
                            <tbody>
                                <% if(wsbitem.sentiment_score > 0){ %>
                                

                                    
                                    <%i++%>
                                    
                                    <tr class="wsbrows">
                                        
                                        <th><u><a href="/symbols/details/<%=wsbitem.ticker%>"><%= (wsbitem.ticker) %></a></u></th>
                                        <td><u><%= (wsbitem.sentiment) %></u></td>
                                        <td><u><%= (wsbitem.sentiment_score) %></u></td> 
                                        <td><u><%= (wsbitem.updatedAt.toLocaleString()) %></u></td> 
                                        
                                    </tr>
                                
                            <% } else{ %>
                                <tr class="wsbrows">
                                            
                                    <th><a href="/symbols/details/<%=wsbitem.ticker%>"><%= (wsbitem.ticker) %></a></th>
                                    <td><%= (wsbitem.sentiment) %></td>
                                    <td><%= (wsbitem.sentiment_score) %></td> 
                                    <td><%= (wsbitem.updatedAt.toLocaleString()) %></td> 
                                    
                    </tr>
                            
                        <%}%>
                    </tbody>
                    
                    
                    <%})%>
                    
                    
                    
    </table>  
    </div>   
          <br>
    <div class="descriptions">
        <p class="box">This table contains all the stocks in the first two columns, and looks at the 20 day breakout and 70 day breakouts. The breakouts are checked by the last close. If the last close is higher than any others in the last 20 days, or 70 days (a value of true), then the stock is expected to increase in value.</p>

        <p class="box">This table is a filtered version of the last one. This contains only the stocks where the average of the last 20 days is higher than the last close. The idea is that if the average over the previous month was at a certain level, the value should move back towards that same level. This is not always true of course.</p>

        <p class="box">This table if from the API Reddit WallStreet Bets. It shows the ratings of each stock and the directions people think that it will go. Bullish for thinking it will go up üìà, and Bearish thinking it will go down üìâ</p>

    </div>       
           
                
               



    
        
                
                
                
      
    

    
</div>